{% extends 'base.html' %}

{% block title %}
    Manage Employees
{% endblock %}

{% block content %}
<div class="container my-5">
    <!-- Page Header -->
    <div class="text-center mb-5">
        <h1 class="display-4 text-primary">Employee Management</h1>
        <p class="text-muted">Easily manage employees' details with options to add, view, and edit.</p>
    </div>

    <!-- Employee List -->
    <div class="card shadow-lg mb-5">
        <div class="card-header bg-gradient-primary text-white">
            <h3 class="mb-0">Employee List</h3>
        </div>
        <div class="card-body">
            <table class="table table-striped table-hover">
                <thead class="bg-dark text-white">
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Department</th>
                        <th>Date of Birth</th>
                        <th>Date of Joining</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for emp in employees %}
                    <tr>
                        <td>{{ emp.id }}</td>
                        <td>{{ emp.first_name }}</td>
                        <td>{{ emp.email }}</td>
                        <td>{{ emp.department }}</td>
                        <td>{{ emp.date_of_birth }}</td>
                        <td>{{ emp.date_of_joining }}</td>
                        <td>
                            <a href="?pk={{ emp.id }}" 
                               class="btn btn-sm btn-warning text-white font-weight-bold shadow edit-btn">
                               <i class="fas fa-edit"></i> Edit
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Add/Edit Employee Form -->
    <div class="card shadow-lg">
        <div class="card-header bg-secondary text-white">
            <h3 class="mb-0">{{ action }} Employee</h3>
        </div>
        <div class="card-body">
            <form method="post" id="employee-form" class="needs-validation" novalidate>
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" class="btn btn-success btn-block btn-lg shadow">
                    <i class="fas fa-save"></i> {{ employee|yesno:"Update Employee,Add Employee" }}
                </button>
            </form>
        </div>
    </div>
</div>


{% block extra_styles %}
<!-- Custom CSS -->
<style>
    /* General styles */
    body {
        font-family: 'Roboto', sans-serif;
        background-color: #f7f9fc;
    }

    /* Header and card shadow styles */
    .card {
        border-radius: 15px;
    }

    .card-header {
        font-size: 1.25rem;
        font-weight: 600;
        border-bottom: 2px solid rgba(0, 0, 0, 0.1);
    }

    .bg-gradient-primary {
        background: linear-gradient(90deg, #007bff, #0056b3);
    }

    /* Table hover and row styling */
    .table-hover tbody tr:hover {
        background-color: #f1f5f9;
        cursor: pointer;
    }

    /* Button styles */
    .btn {
        transition: all 0.3s ease-in-out;
    }

    .btn-warning {
        background-color: #ffc107;
        border: none;
    }

    .btn-warning:hover {
        background-color: #e0a800;
    }

    .btn-success {
        background-color: #28a745;
    }

    .btn-success:hover {
        background-color: #218838;
    }

    /* Form enhancements */
    form .form-group label {
        font-weight: 600;
        color: #333;
    }

    button:focus {
        outline: none;
        box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
    }
</style>


{% block extra_scripts %}
<!-- Add Font Awesome for Icons -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

<script>
    // Confirmation dialog for edits
    document.querySelectorAll('.edit-btn').forEach(button => {
        button.addEventListener('click', event => {
            if (!confirm('Are you sure you want to edit this employee?')) {
                event.preventDefault();
            }
        });
    });

    // Form validation
    (function () {
        'use strict';
        window.addEventListener('load', function () {
            var forms = document.getElementsByClassName('needs-validation');
            Array.prototype.filter.call(forms, function (form) {
                form.addEventListener('submit', function (event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        }, false);
    })();
</script>
{% endblock %}
{% endblock %}
{% endblock %}
